---
title: "fixing columns?"
output: html_notebook
---

Takes the columns that only have to do with the questions
```{r}

shrink_q_columns <- function(country){
  country <- country %>% select(`¿Con cuál partido político simpatiza usted?`:`<NA>`)
}

```

```{r}
argentina_sw <- shrink_q_columns(argentina_wide)
belize_sw  <- shrink_q_columns(belize_wide)
bolivia_sw  <- shrink_q_columns(bolivia_wide)
brazil_sw  <- shrink_q_columns(brazil_wide)
canada_sw  <- shrink_q_columns(canada_wide)
chile_sw  <- shrink_q_columns(chile_wide)
colombia_sw  <- shrink_q_columns(colombia_wide)
costa_sw <- shrink_q_columns(costa_wide)
ecuador_sw <- shrink_q_columns(ecuador_wide)
elsalvador_sw <- shrink_q_columns(elsalvador_wide)
guatemala_sw <- shrink_q_columns(guatemala_wide)
#guyana_sw <- shrink_q_columns(guyana_wide) Commented out because it is English-only
honduras_sw <- shrink_q_columns(honduras_wide)
#jamaica_sw <- shrink_q_columns(jamaica)_wide Commented out because it is English-only
mexico_sw <- shrink_q_columns(mexico_wide)
nicaragua_sw <- shrink_q_columns(nicaragua_wide)
panama_sw <- shrink_q_columns(panama_wide)
paraguay_sw <- shrink_q_columns(paraguay_wide)
peru_sw <- shrink_q_columns(peru_wide)
#suriname_sw <- shrink_q_columns(suriname_wide)
usa_sw <- shrink_q_columns(usa_wide)
uruguay_sw <- shrink_q_columns(uruguay_wide)
venezuela_sw <- shrink_q_columns(venezuela_wide)
```


Uses the same functions made earlier to find all the common questions among the countries- all though the countries had been shrunk earlier based on the column names, it doesn't mean that the column questions are the same, and the column questions might have been repeated and not unique
```{r}
same_column_names <- function(country1, country2) {
  #Collects names of each column from their respective data set
  list1 <- attributes(country1)$names 
  list2 <- attributes(country2)$names
  #Initializing list
  firstlist <- vector("list", 146)

  i <- 1
  n <- 0
  k <- 1

  #Looping through both column names to find similarities
  for (name1 in list1) {
      if (name1 %in% list2) {
        firstlist[[i]] <- name1
        i <- i + 1
      }
    }


  #Getting rid of NULL values
  for(x in firstlist){
    if(is.null(x) == FALSE) {
     n <- n + 1
    }
  }
 
  final <- vector("list", n)

  for(x in firstlist) {
    final[[k]] <- x
    k <- k + 1
  }

  #Print result
  return(final)
}
```


```{r}
list_and_factor <- function(list1, country2) {
  #Collects names of each column from their respective data set
  list2 <- attributes(country2)$names
  #Initializing list
  firstlist <- vector("list", 146)

  i <- 1
  n <- 0
  k <- 1

  #Looping through both column names to find similarities
  for (name1 in list1) {
      if (name1 %in% list2) {
        firstlist[[i]] <- name1
        i <- i + 1
      }
  }


  #Getting rid of NULL values
  for(x in firstlist){
    if(is.null(x) == FALSE) {
     n <- n + 1
    }
  }
 
  final <- vector("list", n)

  for(x in firstlist) {
    final[[k]] <- x
    k <- k + 1
  }

  #Print result
  return(final)
}
```



```{r}
first <- same_column_names(argentina_sw, bolivia_sw)
second <- list_and_factor(first, brazil_sw)
third <- list_and_factor(second, belize_sw)
fourth <- list_and_factor(third, venezuela_sw)
fifth <- list_and_factor(fourth, chile_sw)
sixth <- list_and_factor(fifth, colombia_sw)
seven <- list_and_factor(sixth, costa_sw)
eigth <- list_and_factor(seven, ecuador_sw)
nine <- list_and_factor(eigth, elsalvador_sw)
ten <- list_and_factor(nine, guatemala_sw)
#eleven <- list_and_factor(ten, guyana_sw)
twelve <- list_and_factor(ten, paraguay_sw)
thirteen <- list_and_factor(twelve, honduras_sw)
#fourteen <- list_and_factor(thirteen, jamaica_sw)
fifteen <- list_and_factor(thirteen, mexico_sw)
sixteen <- list_and_factor(fifteen, nicaragua_sw)
seventeen <- list_and_factor(sixteen, panama_sw)
eighteen <- list_and_factor(seventeen, peru_sw)
#nineteen <- list_and_factor(eighteen, suriname_sw)
twenty <- list_and_factor(eighteen, usa_sw)
twen_one <- list_and_factor(twenty, uruguay_sw)
common_questions <- (list_and_factor(twen_one, canada_sw))
unique_questions <- unique(common_questions)
unlist_questions <- (unlist(unique_questions))
```


takes the unique list of questions and then shrinks the countries
```{r}
argentina_sw <- argentina_sw[,unlist_questions]
belize_sw <- belize_sw[,unlist_questions]
bolivia_sw  <- bolivia_sw[,unlist_questions]
brazil_sw  <- brazil_sw[,unlist_questions]
canada_sw  <- canada_sw[,unlist_questions]
chile_sw  <- chile_sw[,unlist_questions]
colombia_sw  <- colombia_sw[,unlist_questions]
costa_sw <- costa_sw[,unlist_questions]
ecuador_sw <- ecuador_sw[,unlist_questions]
elsalvador_sw <- elsalvador_sw[,unlist_questions]
guatemala_sw <- guatemala_sw[,unlist_questions]
#guyana_sw <- guyana_sw[,unlist_questions] Commented out because it is English-only
honduras_sw <- honduras_sw[,unlist_questions]
#jamaica_sw <- jamaica_sw[,unlist_questions] Commented out because it is English-only
mexico_sw <- mexico_sw[,unlist_questions]
nicaragua_sw <- nicaragua_sw[,unlist_questions]
panama_sw <- panama_sw[,unlist_questions]
paraguay_sw <- paraguay_sw[,unlist_questions]
peru_sw <- peru_sw[,unlist_questions]
#suriname_sw <- suriname_sw[,unlist_questions]
usa_sw <- usa_sw[,unlist_questions]
uruguay_sw <- uruguay_sw[,unlist_questions]
venezuela_sw <- venezuela_sw[,unlist_questions]

#test <- bind_rows(argentina_sw, belize_sw)
```

selects the columns that don't have questions for column names
```{r}
first_section <- function(country){
  country_new <- country %>% select(pais:extra_id)
}
```


```{r}
argentina_new <- first_section(argentina_wide)
belize_new  <- first_section(belize_wide)
bolivia_new  <- first_section(bolivia_wide)
brazil_new  <- first_section(brazil_wide)
canada_new  <- first_section(canada_wide)
chile_new  <- first_section(chile_wide)
colombia_new  <- first_section(colombia_wide)
costa_new <- first_section(costa_wide)
ecuador_new <- first_section(ecuador_wide)
elsalvador_new <- first_section(elsalvador_wide)
guatemala_new <- first_section(guatemala_wide)
#guyana_new <- first_section(guyana_wide) Commented out because it is English-only
honduras_new <- first_section(honduras_wide)
#jamaica_new <- first_section(jamaica)_wide Commented out because it is English-only
mexico_new <- first_section(mexico_wide)
nicaragua_new <- first_section(nicaragua_wide)
panama_new <- first_section(panama_wide)
paraguay_new <- first_section(paraguay_wide)
peru_new <- first_section(peru_wide)
#suriname_new <- first_section(suriname_wide)
usa_new <- first_section(usa_wide)
uruguay_new <- first_section(uruguay_wide)
venezuela_new <- first_section(venezuela_wide)


```

Binds the columns of the shrunk table with the questions and the ones that don't have questions for colum names
```{r}
argentina_full <- bind_cols(argentina_new, argentina_sw)
belize_full  <- bind_cols(belize_new, belize_sw)
bolivia_full  <- bind_cols(bolivia_new, bolivia_sw)
brazil_full  <- bind_cols(brazil_new, brazil_sw)
canada_full  <- bind_cols(canada_new, canada_sw)
chile_full  <- bind_cols(chile_new, chile_sw)
colombia_full  <- bind_cols(colombia_new, colombia_sw)
costa_full <- bind_cols(costa_new, costa_sw)
ecuador_full <- bind_cols(ecuador_new, ecuador_sw)
elsalvador_full <- bind_cols(elsalvador_new, elsalvador_sw)
guatemala_full <- bind_cols(guatemala_new, guatemala_sw)
#guyana_full <- bind_cols(guyana_new, guyana_sw) Commented out because it is English-only
honduras_full <- bind_cols(honduras_new, honduras_sw)
#jamaica_full <- bind_cols(jamaica_new, jamaica_sw) Commented out because it is English-only
mexico_full <- bind_cols(mexico_new, mexico_sw)
nicaragua_full <- bind_cols(nicaragua_new, nicaragua_sw)
panama_full <- bind_cols(panama_new, panama_sw)
paraguay_full <- bind_cols(paraguay_new, paraguay_sw)
peru_full <- bind_cols(peru_new, peru_sw)
#suriname_full <- bind_cols(suriname_new, suriname_sw)
usa_full <- bind_cols(usa_new, usa_sw)
uruguay_full <- bind_cols(uruguay_new, uruguay_sw)
venezuela_full <- bind_cols(venezuela_new, venezuela_sw)


```

Then binds all of the data frames together to create the master merge
```{r}
first <- bind_rows(argentina_full, bolivia_full)
second <- bind_rows(first, brazil_full)
third <- bind_rows(second, belize_full)
fourth <- bind_rows(third, canada_full)
fifth <- bind_rows(fourth, chile_full)
sixth <- bind_rows(fifth, colombia_full)
seven <- bind_rows(sixth, costa_full)
eigth <- bind_rows(seven, ecuador_full)
nine <- bind_rows(eigth, elsalvador_full)
ten <- bind_rows(nine, guatemala_full)
#eleven <- bind_rows(ten, guyana_full)
twelve <- bind_rows(nine, paraguay_full)
thirteen <- bind_rows(twelve, honduras_full)
#fourteen <- bind_rows(thirteen, jamaica_full)
fifteen <- bind_rows(thirteen, mexico_full)
sixteen <- bind_rows(fifteen, nicaragua_full)
seventeen <- bind_rows(sixteen, panama_full)
eighteen <- bind_rows(seventeen, peru_full)
#nineteen <- bind_rows(eighteen, suriname_full)
twenty <- bind_rows(eighteen, usa_full)
twen_one <- bind_rows(twenty, uruguay_full)
last_combine <- bind_rows(twen_one, venezuela_full)

write_csv(last_combine, "clean_combined_tidy.csv")
```




